"use strict";
self["webpackHotUpdateboilerplate_prismic"]("main",{

/***/ "./app/components/Canvas/Home/index.js":
/*!*********************************************!*\
  !*** ./app/components/Canvas/Home/index.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var ogl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ogl */ "./node_modules/ogl/src/core/Transform.js");
/* harmony import */ var ogl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ogl */ "./node_modules/ogl/src/extras/Plane.js");
/* harmony import */ var gsap__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! gsap */ "./node_modules/gsap/index.js");
/* harmony import */ var lodash_map__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash/map */ "./node_modules/lodash/map.js");
/* harmony import */ var lodash_map__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash_map__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _Media__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Media */ "./app/components/Canvas/Home/Media.js");




/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (class {
  constructor({
    gl,
    scene,
    sizes
  }) {
    this.gl = gl;
    this.scene = scene;
    this.sizes = sizes;
    this.group = new ogl__WEBPACK_IMPORTED_MODULE_2__.Transform();
    this.galleryElement = document.querySelector('.home__gallery');
    this.mediasElements = document.querySelectorAll('.home__gallery__media__image');
    this.x = {
      current: 0,
      target: 0,
      lerp: 0.1
    };
    this.y = {
      current: 0,
      target: 0,
      lerp: 0.1
    };
    this.scrollCurrent = {
      x: 0,
      y: 0
    };
    this.scroll = {
      x: 0,
      y: 0
    };
    this.speed = {
      current: 0,
      target: 0,
      lerp: 0.1
    };
    this.createGeometry();
    this.createGallery();
    this.onResize({
      sizes: this.sizes
    });
    this.group.setParent(this.scene);
    this.show();
  }
  createGeometry() {
    this.geometry = new ogl__WEBPACK_IMPORTED_MODULE_3__.Plane(this.gl, {
      heightSegments: 20,
      widthSegments: 20
    });
  }
  createGallery() {
    this.medias = lodash_map__WEBPACK_IMPORTED_MODULE_0___default()(this.mediasElements, (element, index) => {
      return new _Media__WEBPACK_IMPORTED_MODULE_1__["default"]({
        element,
        geometry: this.geometry,
        index,
        gl: this.gl,
        scene: this.group,
        sizes: this.sizes
      });
    });
  }

  /****
   * ANIMATIONS
   * ***/
  show() {
    lodash_map__WEBPACK_IMPORTED_MODULE_0___default()(this.medias, media => media.show());
  }
  hide() {
    lodash_map__WEBPACK_IMPORTED_MODULE_0___default()(this.medias, media => media.hide());
  }

  /****
   * EVENTS
   * ***/
  onResize(event) {
    this.galleryBounds = this.galleryElement.getBoundingClientRect();
    this.sizes = event.sizes;
    this.gallerySizes = {
      height: this.galleryBounds.height / window.innerHeight * this.sizes.height,
      width: this.galleryBounds.width / window.innerWidth * this.sizes.width
    };
    this.scroll.x = this.x.target = 0;
    this.scroll.y = this.y.target = 0;
    lodash_map__WEBPACK_IMPORTED_MODULE_0___default()(this.medias, media => media.onResize(event, this.scroll));
  }
  onTouchDown({
    x,
    y
  }) {}
  onTouchMove({
    x,
    y
  }) {}
  onTouchUp({
    x,
    y
  }) {}
  onWheel({
    pixelX,
    pixelY
  }) {
    // this.x.target += pixelX
    this.y.target += pixelY;
  }

  /****
   * LOOP
   * ***/
  update() {
    this.speed.current = gsap__WEBPACK_IMPORTED_MODULE_4__["default"].utils.interpolate(this.speed.current, this.speed.target, this.speed.lerp);
    this.x.current = gsap__WEBPACK_IMPORTED_MODULE_4__["default"].utils.interpolate(this.x.current, this.x.target, this.x.lerp);
    this.y.current = gsap__WEBPACK_IMPORTED_MODULE_4__["default"].utils.interpolate(this.y.current, this.y.target, this.y.lerp);
    if (this.scroll.y < this.y.current) {
      this.y.direction = 'top';
    } else if (this.scroll.y > this.y.current) {
      this.y.direction = 'bottom';
    }
    this.scroll.x = this.x.current;
    this.scroll.y = this.y.current;
    lodash_map__WEBPACK_IMPORTED_MODULE_0___default()(this.medias, (media, index) => {
      const offsetY = this.sizes.height * 0.6;
      const scaleY = media.mesh.scale.y / 2;
      if (index % 2 === 0) {
        this.multiplier = -1;
      } else if (index % 2 === 1) {
        this.multiplier = 1;
      }
      if (this.multiplier === 1) {
        if (this.y.direction === 'top') {
          const y = media.mesh.position.y + scaleY;
          if (y < -offsetY) {
            media.extra.y += this.gallerySizes.height;
          }
        } else if (this.y.direction === 'bottom') {
          const y = media.mesh.position.y - scaleY;
          if (y > offsetY) {
            media.extra.y -= this.gallerySizes.height;
          }
        }
      } else if (this.multiplier === -1) {
        if (this.y.direction === 'top') {
          // const y = media.mesh.position.y + scaleY
          // const test = this.gallerySizes.height * this.multiplier
          // if (y < -offsetY) {
          //   media.extra.y += test
          // }
        } else if (this.y.direction === 'bottom') {
          // const y = media.mesh.position.y - scaleY
          // const test = this.gallerySizes.height
          // if (y > offsetY) {
          //   media.extra.y -= test
          // }
        }
      }
      media.update(this.scroll, this.speed.current, this.multiplier);
    });
  }

  /****
   * DESTROY
   * ***/
  destroy() {
    this.scene.removeChild(this.group);
  }
});

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("f48e43881ffdae8fa050")
/******/ })();
/******/ 
/******/ }
);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi42YjdlYjM1ZWQzMDVkYTAwMzhlZC5ob3QtdXBkYXRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0M7QUFDZjtBQUVLO0FBRUQ7QUFFM0IsaUVBQWUsTUFBTTtFQUNuQkssV0FBV0EsQ0FBRTtJQUFFQyxFQUFFO0lBQUVDLEtBQUs7SUFBRUM7RUFBTSxDQUFDLEVBQUU7SUFDakMsSUFBSSxDQUFDRixFQUFFLEdBQUdBLEVBQUU7SUFDWixJQUFJLENBQUNDLEtBQUssR0FBR0EsS0FBSztJQUNsQixJQUFJLENBQUNDLEtBQUssR0FBR0EsS0FBSztJQUVsQixJQUFJLENBQUNDLEtBQUssR0FBRyxJQUFJUiwwQ0FBUyxDQUFDLENBQUM7SUFFNUIsSUFBSSxDQUFDUyxjQUFjLEdBQUdDLFFBQVEsQ0FBQ0MsYUFBYSxDQUFDLGdCQUFnQixDQUFDO0lBQzlELElBQUksQ0FBQ0MsY0FBYyxHQUFHRixRQUFRLENBQUNHLGdCQUFnQixDQUFDLDhCQUE4QixDQUFDO0lBRS9FLElBQUksQ0FBQ0MsQ0FBQyxHQUFHO01BQ1BDLE9BQU8sRUFBRSxDQUFDO01BQ1ZDLE1BQU0sRUFBRSxDQUFDO01BQ1RDLElBQUksRUFBRTtJQUNSLENBQUM7SUFFRCxJQUFJLENBQUNDLENBQUMsR0FBRztNQUNQSCxPQUFPLEVBQUUsQ0FBQztNQUNWQyxNQUFNLEVBQUUsQ0FBQztNQUNUQyxJQUFJLEVBQUU7SUFDUixDQUFDO0lBRUQsSUFBSSxDQUFDRSxhQUFhLEdBQUc7TUFDbkJMLENBQUMsRUFBRSxDQUFDO01BQ0pJLENBQUMsRUFBRTtJQUNMLENBQUM7SUFFRCxJQUFJLENBQUNFLE1BQU0sR0FBRztNQUNaTixDQUFDLEVBQUUsQ0FBQztNQUNKSSxDQUFDLEVBQUU7SUFDTCxDQUFDO0lBRUQsSUFBSSxDQUFDRyxLQUFLLEdBQUc7TUFDWE4sT0FBTyxFQUFFLENBQUM7TUFDVkMsTUFBTSxFQUFFLENBQUM7TUFDVEMsSUFBSSxFQUFFO0lBQ1IsQ0FBQztJQUVELElB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cUMsTUFBTTtVQUN4QyxJQUFJckMsQ0FBQyxHQUFHb0MsT0FBTyxFQUFFO1lBQ2ZyQixLQUFLLENBQUMyQixLQUFLLENBQUMxQyxDQUFDLElBQUksSUFBSSxDQUFDb0IsWUFBWSxDQUFDQyxNQUFNO1VBQzNDO1FBQ0Y7TUFDRixDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUNtQixVQUFVLEtBQUssQ0FBQyxDQUFDLEVBQUU7UUFDakMsSUFBSSxJQUFJLENBQUN4QyxDQUFDLENBQUNtQyxTQUFTLEtBQUssS0FBSyxFQUFFO1VBQzlCO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7UUFBQSxDQUNELE1BQU0sSUFBSSxJQUFJLENBQUNuQyxDQUFDLENBQUNtQyxTQUFTLEtBQUssUUFBUSxFQUFFO1VBQ3hDO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7UUFBQTtNQUVKO01BRUFwQixLQUFLLENBQUNpQixNQUFNLENBQUMsSUFBSSxDQUFDOUIsTUFBTSxFQUFFLElBQUksQ0FBQ0MsS0FBSyxDQUFDTixPQUFPLEVBQUUsSUFBSSxDQUFDMkMsVUFBVSxDQUFDO0lBQ2hFLENBQUMsQ0FBQztFQUNKOztFQUVBO0FBQ0Y7QUFDQTtFQUNFRyxPQUFPQSxDQUFBLEVBQUk7SUFDVCxJQUFJLENBQUN2RCxLQUFLLENBQUN3RCxXQUFXLENBQUMsSUFBSSxDQUFDdEQsS0FBSyxDQUFDO0VBQ3BDO0FBQ0Y7Ozs7Ozs7O1VDOUxBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYm9pbGVycGxhdGUtcHJpc21pYy8uL2FwcC9jb21wb25lbnRzL0NhbnZhcy9Ib21lL2luZGV4LmpzIiwid2VicGFjazovL2JvaWxlcnBsYXRlLXByaXNtaWMvd2VicGFjay9ydW50aW1lL2dldEZ1bGxIYXNoIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBsYW5lLCBUcmFuc2Zvcm0gfSBmcm9tICdvZ2wnXG5pbXBvcnQgR1NBUCBmcm9tICdnc2FwJ1xuXG5pbXBvcnQgbWFwIGZyb20gJ2xvZGFzaC9tYXAnXG5cbmltcG9ydCBNZWRpYSBmcm9tICcuL01lZGlhJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yICh7IGdsLCBzY2VuZSwgc2l6ZXMgfSkge1xuICAgIHRoaXMuZ2wgPSBnbFxuICAgIHRoaXMuc2NlbmUgPSBzY2VuZVxuICAgIHRoaXMuc2l6ZXMgPSBzaXplc1xuXG4gICAgdGhpcy5ncm91cCA9IG5ldyBUcmFuc2Zvcm0oKVxuXG4gICAgdGhpcy5nYWxsZXJ5RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ob21lX19nYWxsZXJ5JylcbiAgICB0aGlzLm1lZGlhc0VsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmhvbWVfX2dhbGxlcnlfX21lZGlhX19pbWFnZScpXG5cbiAgICB0aGlzLnggPSB7XG4gICAgICBjdXJyZW50OiAwLFxuICAgICAgdGFyZ2V0OiAwLFxuICAgICAgbGVycDogMC4xXG4gICAgfVxuXG4gICAgdGhpcy55ID0ge1xuICAgICAgY3VycmVudDogMCxcbiAgICAgIHRhcmdldDogMCxcbiAgICAgIGxlcnA6IDAuMVxuICAgIH1cblxuICAgIHRoaXMuc2Nyb2xsQ3VycmVudCA9IHtcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwXG4gICAgfVxuXG4gICAgdGhpcy5zY3JvbGwgPSB7XG4gICAgICB4OiAwLFxuICAgICAgeTogMFxuICAgIH1cblxuICAgIHRoaXMuc3BlZWQgPSB7XG4gICAgICBjdXJyZW50OiAwLFxuICAgICAgdGFyZ2V0OiAwLFxuICAgICAgbGVycDogMC4xXG4gICAgfVxuXG4gICAgdGhpcy5jcmVhdGVHZW9tZXRyeSgpXG4gICAgdGhpcy5jcmVhdGVHYWxsZXJ5KClcbiAgICB0aGlzLm9uUmVzaXplKHtcbiAgICAgIHNpemVzOiB0aGlzLnNpemVzXG4gICAgfSlcblxuICAgIHRoaXMuZ3JvdXAuc2V0UGFyZW50KHRoaXMuc2NlbmUpXG5cbiAgICB0aGlzLnNob3coKVxuICB9XG5cbiAgY3JlYXRlR2VvbWV0cnkgKCkge1xuICAgIHRoaXMuZ2VvbWV0cnkgPSBuZXcgUGxhbmUodGhpcy5nbCwge1xuICAgICAgaGVpZ2h0U2VnbWVudHM6IDIwLFxuICAgICAgd2lkdGhTZWdtZW50czogMjBcbiAgICB9KVxuICB9XG5cbiAgY3JlYXRlR2FsbGVyeSAoKSB7XG4gICAgdGhpcy5tZWRpYXMgPSBtYXAodGhpcy5tZWRpYXNFbGVtZW50cywgKGVsZW1lbnQsIGluZGV4KSA9PiB7XG4gICAgICByZXR1cm4gbmV3IE1lZGlhKHtcbiAgICAgICAgZWxlbWVudCxcbiAgICAgICAgZ2VvbWV0cnk6IHRoaXMuZ2VvbWV0cnksXG4gICAgICAgIGluZGV4LFxuICAgICAgICBnbDogdGhpcy5nbCxcbiAgICAgICAgc2NlbmU6IHRoaXMuZ3JvdXAsXG4gICAgICAgIHNpemVzOiB0aGlzLnNpemVzXG4gICAgICB9KVxuICAgIH0pXG4gIH1cblxuICAvKioqKlxuICAgKiBBTklNQVRJT05TXG4gICAqICoqKi9cbiAgc2hvdyAoKSB7XG4gICAgbWFwKHRoaXMubWVkaWFzLCBtZWRpYSA9PiBtZWRpYS5zaG93KCkpXG4gIH1cblxuICBoaWRlICgpIHtcbiAgICBtYXAodGhpcy5tZWRpYXMsIG1lZGlhID0+IG1lZGlhLmhpZGUoKSlcbiAgfVxuXG4gIC8qKioqXG4gICAqIEVWRU5UU1xuICAgKiAqKiovXG4gIG9uUmVzaXplIChldmVudCkge1xuICAgIHRoaXMuZ2FsbGVyeUJvdW5kcyA9IHRoaXMuZ2FsbGVyeUVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcblxuICAgIHRoaXMuc2l6ZXMgPSBldmVudC5zaXplc1xuXG4gICAgdGhpcy5nYWxsZXJ5U2l6ZXMgPSB7XG4gICAgICBoZWlnaHQ6IHRoaXMuZ2FsbGVyeUJvdW5kcy5oZWlnaHQgLyB3aW5kb3cuaW5uZXJIZWlnaHQgKiB0aGlzLnNpemVzLmhlaWdodCxcbiAgICAgIHdpZHRoOiB0aGlzLmdhbGxlcnlCb3VuZHMud2lkdGggLyB3aW5kb3cuaW5uZXJXaWR0aCAqIHRoaXMuc2l6ZXMud2lkdGhcbiAgICB9XG5cbiAgICB0aGlzLnNjcm9sbC54ID0gdGhpcy54LnRhcmdldCA9IDBcbiAgICB0aGlzLnNjcm9sbC55ID0gdGhpcy55LnRhcmdldCA9IDBcblxuICAgIG1hcCh0aGlzLm1lZGlhcywgbWVkaWEgPT4gbWVkaWEub25SZXNpemUoZXZlbnQsIHRoaXMuc2Nyb2xsKSlcbiAgfVxuXG4gIG9uVG91Y2hEb3duICh7IHgsIHkgfSkge1xuXG4gIH1cblxuICBvblRvdWNoTW92ZSAoeyB4LCB5IH0pIHtcblxuICB9XG5cbiAgb25Ub3VjaFVwICh7IHgsIHkgfSkge1xuXG4gIH1cblxuICBvbldoZWVsICh7IHBpeGVsWCwgcGl4ZWxZIH0pIHtcbiAgICAvLyB0aGlzLngudGFyZ2V0ICs9IHBpeGVsWFxuICAgIHRoaXMueS50YXJnZXQgKz0gcGl4ZWxZXG4gIH1cblxuICAvKioqKlxuICAgKiBMT09QXG4gICAqICoqKi9cbiAgdXBkYXRlICgpIHtcbiAgICB0aGlzLnNwZWVkLmN1cnJlbnQgPSBHU0FQLnV0aWxzLmludGVycG9sYXRlKHRoaXMuc3BlZWQuY3VycmVudCwgdGhpcy5zcGVlZC50YXJnZXQsIHRoaXMuc3BlZWQubGVycClcblxuICAgIHRoaXMueC5jdXJyZW50ID0gR1NBUC51dGlscy5pbnRlcnBvbGF0ZSh0aGlzLnguY3VycmVudCwgdGhpcy54LnRhcmdldCwgdGhpcy54LmxlcnApXG4gICAgdGhpcy55LmN1cnJlbnQgPSBHU0FQLnV0aWxzLmludGVycG9sYXRlKHRoaXMueS5jdXJyZW50LCB0aGlzLnkudGFyZ2V0LCB0aGlzLnkubGVycClcblxuICAgIGlmICh0aGlzLnNjcm9sbC55IDwgdGhpcy55LmN1cnJlbnQpIHtcbiAgICAgIHRoaXMueS5kaXJlY3Rpb24gPSAndG9wJ1xuICAgIH0gZWxzZSBpZiAodGhpcy5zY3JvbGwueSA+IHRoaXMueS5jdXJyZW50KSB7XG4gICAgICB0aGlzLnkuZGlyZWN0aW9uID0gJ2JvdHRvbSdcbiAgICB9XG5cbiAgICB0aGlzLnNjcm9sbC54ID0gdGhpcy54LmN1cnJlbnRcbiAgICB0aGlzLnNjcm9sbC55ID0gdGhpcy55LmN1cnJlbnRcblxuICAgIG1hcCh0aGlzLm1lZGlhcywgKG1lZGlhLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3Qgb2Zmc2V0WSA9IHRoaXMuc2l6ZXMuaGVpZ2h0ICogMC42XG4gICAgICBjb25zdCBzY2FsZVkgPSBtZWRpYS5tZXNoLnNjYWxlLnkgLyAyXG5cbiAgICAgIGlmIChpbmRleCAlIDIgPT09IDApIHtcbiAgICAgICAgdGhpcy5tdWx0aXBsaWVyID0gLTFcbiAgICAgIH0gZWxzZSBpZiAoaW5kZXggJSAyID09PSAxKSB7XG4gICAgICAgIHRoaXMubXVsdGlwbGllciA9IDFcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMubXVsdGlwbGllciA9PT0gMSkge1xuICAgICAgICBpZiAodGhpcy55LmRpcmVjdGlvbiA9PT0gJ3RvcCcpIHtcbiAgICAgICAgICBjb25zdCB5ID0gbWVkaWEubWVzaC5wb3NpdGlvbi55ICsgc2NhbGVZXG4gICAgICAgICAgaWYgKHkgPCAtb2Zmc2V0WSkge1xuICAgICAgICAgICAgbWVkaWEuZXh0cmEueSArPSB0aGlzLmdhbGxlcnlTaXplcy5oZWlnaHRcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy55LmRpcmVjdGlvbiA9PT0gJ2JvdHRvbScpIHtcbiAgICAgICAgICBjb25zdCB5ID0gbWVkaWEubWVzaC5wb3NpdGlvbi55IC0gc2NhbGVZXG4gICAgICAgICAgaWYgKHkgPiBvZmZzZXRZKSB7XG4gICAgICAgICAgICBtZWRpYS5leHRyYS55IC09IHRoaXMuZ2FsbGVyeVNpemVzLmhlaWdodFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmICh0aGlzLm11bHRpcGxpZXIgPT09IC0xKSB7XG4gICAgICAgIGlmICh0aGlzLnkuZGlyZWN0aW9uID09PSAndG9wJykge1xuICAgICAgICAgIC8vIGNvbnN0IHkgPSBtZWRpYS5tZXNoLnBvc2l0aW9uLnkgKyBzY2FsZVlcbiAgICAgICAgICAvLyBjb25zdCB0ZXN0ID0gdGhpcy5nYWxsZXJ5U2l6ZXMuaGVpZ2h0ICogdGhpcy5tdWx0aXBsaWVyXG4gICAgICAgICAgLy8gaWYgKHkgPCAtb2Zmc2V0WSkge1xuICAgICAgICAgIC8vICAgbWVkaWEuZXh0cmEueSArPSB0ZXN0XG4gICAgICAgICAgLy8gfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMueS5kaXJlY3Rpb24gPT09ICdib3R0b20nKSB7XG4gICAgICAgICAgLy8gY29uc3QgeSA9IG1lZGlhLm1lc2gucG9zaXRpb24ueSAtIHNjYWxlWVxuICAgICAgICAgIC8vIGNvbnN0IHRlc3QgPSB0aGlzLmdhbGxlcnlTaXplcy5oZWlnaHRcbiAgICAgICAgICAvLyBpZiAoeSA+IG9mZnNldFkpIHtcbiAgICAgICAgICAvLyAgIG1lZGlhLmV4dHJhLnkgLT0gdGVzdFxuICAgICAgICAgIC8vIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBtZWRpYS51cGRhdGUodGhpcy5zY3JvbGwsIHRoaXMuc3BlZWQuY3VycmVudCwgdGhpcy5tdWx0aXBsaWVyKVxuICAgIH0pXG4gIH1cblxuICAvKioqKlxuICAgKiBERVNUUk9ZXG4gICAqICoqKi9cbiAgZGVzdHJveSAoKSB7XG4gICAgdGhpcy5zY2VuZS5yZW1vdmVDaGlsZCh0aGlzLmdyb3VwKVxuICB9XG59XG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmggPSAoKSA9PiAoXCJmNDhlNDM4ODFmZmRhZThmYTA1MFwiKSJdLCJuYW1lcyI6WyJQbGFuZSIsIlRyYW5zZm9ybSIsIkdTQVAiLCJtYXAiLCJNZWRpYSIsImNvbnN0cnVjdG9yIiwiZ2wiLCJzY2VuZSIsInNpemVzIiwiZ3JvdXAiLCJnYWxsZXJ5RWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm1lZGlhc0VsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsIngiLCJjdXJyZW50IiwidGFyZ2V0IiwibGVycCIsInkiLCJzY3JvbGxDdXJyZW50Iiwic2Nyb2xsIiwic3BlZWQiLCJjcmVhdGVHZW9tZXRyeSIsImNyZWF0ZUdhbGxlcnkiLCJvblJlc2l6ZSIsInNldFBhcmVudCIsInNob3ciLCJnZW9tZXRyeSIsImhlaWdodFNlZ21lbnRzIiwid2lkdGhTZWdtZW50cyIsIm1lZGlhcyIsImVsZW1lbnQiLCJpbmRleCIsIm1lZGlhIiwiaGlkZSIsImV2ZW50IiwiZ2FsbGVyeUJvdW5kcyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImdhbGxlcnlTaXplcyIsImhlaWdodCIsIndpbmRvdyIsImlubmVySGVpZ2h0Iiwid2lkdGgiLCJpbm5lcldpZHRoIiwib25Ub3VjaERvd24iLCJvblRvdWNoTW92ZSIsIm9uVG91Y2hVcCIsIm9uV2hlZWwiLCJwaXhlbFgiLCJwaXhlbFkiLCJ1cGRhdGUiLCJ1dGlscyIsImludGVycG9sYXRlIiwiZGlyZWN0aW9uIiwib2Zmc2V0WSIsInNjYWxlWSIsIm1lc2giLCJzY2FsZSIsIm11bHRpcGxpZXIiLCJwb3NpdGlvbiIsImV4dHJhIiwiZGVzdHJveSIsInJlbW92ZUNoaWxkIl0sInNvdXJjZVJvb3QiOiIifQ==