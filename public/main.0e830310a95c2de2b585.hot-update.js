"use strict";
self["webpackHotUpdateboilerplate_prismic"]("main",{

/***/ "./app/index.js":
/*!**********************!*\
  !*** ./app/index.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var normalize_wheel__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! normalize-wheel */ "./node_modules/normalize-wheel/index.js");
/* harmony import */ var normalize_wheel__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(normalize_wheel__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var lodash_each__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash/each */ "./node_modules/lodash/each.js");
/* harmony import */ var lodash_each__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash_each__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var components_Canvas__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! components/Canvas */ "./app/components/Canvas/index.js");
/* harmony import */ var components_Preloader__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! components/Preloader */ "./app/components/Preloader.js");
/* harmony import */ var pages_About__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! pages/About */ "./app/pages/About/index.js");
/* harmony import */ var pages_Home__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! pages/Home */ "./app/pages/Home/index.js");






class App {
  constructor() {
    this.createContent();
    this.createCanvas();
    this.createPreloader();
    this.createPages();
    this.addEventListeners();
    this.addLinkListeners();
    this.onResize();
    this.update();
  }
  createPreloader() {
    this.preloader = new components_Preloader__WEBPACK_IMPORTED_MODULE_3__["default"]({
      canvas: this.canvas
    });
    this.preloader.once('completed', this.onPreloaded.bind(this));
  }
  createCanvas() {
    this.canvas = new components_Canvas__WEBPACK_IMPORTED_MODULE_2__["default"]({
      template: this.template
    });
  }
  createContent() {
    this.content = document.querySelector('.content');
    this.template = this.content.getAttribute('data-template');
  }
  createPages() {
    this.pages = {
      about: new pages_About__WEBPACK_IMPORTED_MODULE_4__["default"](),
      home: new pages_Home__WEBPACK_IMPORTED_MODULE_5__["default"]()
    };
    this.page = this.pages[this.template];
    this.page.create();
    this.onResize();
  }

  /****
   * EVENTS
   * ***/
  onPreloaded() {
    this.onResize();
    this.canvas.onPreloaded();
    this.page.show();
  }
  onPopState() {
    this.onChange({
      url: window.location.pathname,
      push: false
    });
  }
  async onChange({
    url,
    push = true
  }) {
    this.canvas.onChangeStart(this.template, url);
    await this.page.hide();
    const request = await window.fetch(url);
    if (request.status === 200) {
      const html = await request.text();
      const div = document.createElement('div');
      window.history.pushState({}, '', url);
      if (push) {
        window.history.pushState({}, '', url);
      }
      div.innerHTML = html;
      const divContent = div.querySelector('.content');
      this.template = divContent.getAttribute('data-template');
      this.navigation.onChange(this.template);
      this.content.setAttribute('data-template', this.template);
      this.content.innerHTML = divContent.innerHTML;
      this.canvas.onChangeEnd(this.template);
      this.page = this.pages[this.template];
      this.page.create();
      this.onResize();
      this.page.show();
      this.addLinkListeners();
    } else {
      console.log('Error');
    }
  }
  onResize() {
    window.requestAnimationFrame(_ => {
      if (this.canvas && this.canvas.onResize) {
        this.canvas.onResize();
      }
    });
    if (this.page && this.page.onResize) {
      this.page.onResize();
    }
  }
  onTouchDown(event) {
    if (this.canvas && this.canvas.onTouchDown) {
      this.canvas.onTouchDown(event);
    }
  }
  onTouchMove(event) {
    if (this.canvas && this.canvas.onTouchMove) {
      this.canvas.onTouchMove(event);
    }
  }
  onTouchUp(event) {
    if (this.canvas && this.canvas.onTouchUp) {
      this.canvas.onTouchUp(event);
    }
  }
  onWheel(event) {
    const normalizedWheel = normalize_wheel__WEBPACK_IMPORTED_MODULE_0___default()(event);
    if (this.canvas && this.canvas.update) {
      this.canvas.onWheel(normalizedWheel);
    }
    if (this.page && this.page.update) {
      this.page.onWheel(normalizedWheel);
    }
  }

  /****
   * LOOPS
   * ***/
  update() {
    if (this.page && this.page.update) {
      this.page.update();
    }
    if (this.canvas && this.canvas.update) {
      this.canvas.update(this.page.scroll);
    }
    this.frame = window.requestAnimationFrame(this.update.bind(this));
  }

  /****
   * LISTENERS
   * ***/
  addEventListeners() {
    window.addEventListener('mousewheel', this.onWheel.bind(this));
    window.addEventListener('mousedown', this.onTouchDown.bind(this));
    window.addEventListener('mousemove', this.onTouchMove.bind(this));
    window.addEventListener('mouseup', this.onTouchUp.bind(this));
    window.addEventListener('touchstart', this.onTouchDown.bind(this));
    window.addEventListener('touchmove', this.onTouchMove.bind(this));
    window.addEventListener('touchend', this.onTouchUp.bind(this));
    window.addEventListener('popstate', this.onPopState.bind(this));
    window.addEventListener('resize', this.onResize.bind(this));
  }
}
new App();

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("ac50af76c21a20277aa7")
/******/ })();
/******/ 
/******/ }
);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi4wZTgzMDMxMGE5NWMyZGUyYjU4NS5ob3QtdXBkYXRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE0QztBQUVkO0FBRVE7QUFFTTtBQUViO0FBQ0Y7QUFDN0IsTUFBTU0sR0FBRyxDQUFDO0VBQ1JDLFdBQVdBLENBQUEsRUFBSTtJQUNiLElBQUksQ0FBQ0MsYUFBYSxDQUFDLENBQUM7SUFFcEIsSUFBSSxDQUFDQyxZQUFZLENBQUMsQ0FBQztJQUNuQixJQUFJLENBQUNDLGVBQWUsQ0FBQyxDQUFDO0lBQ3RCLElBQUksQ0FBQ0MsV0FBVyxDQUFDLENBQUM7SUFFbEIsSUFBSSxDQUFDQyxpQkFBaUIsQ0FBQyxDQUFDO0lBQ3hCLElBQUksQ0FBQ0MsZ0JBQWdCLENBQUMsQ0FBQztJQUV2QixJQUFJLENBQUNDLFFBQVEsQ0FBQyxDQUFDO0lBRWYsSUFBSSxDQUFDQyxNQUFNLENBQUMsQ0FBQztFQUNmO0VBRUFMLGVBQWVBLENBQUEsRUFBSTtJQUNqQixJQUFJLENBQUNNLFNBQVMsR0FBRyxJQUFJYiw0REFBUyxDQUFDO01BQzdCYyxNQUFNLEVBQUUsSUFBSSxDQUFDQTtJQUNmLENBQUMsQ0FBQztJQUNGLElBQUksQ0FBQ0QsU0FBUyxDQUFDRSxJQUFJLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQ0MsV0FBVyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7RUFDL0Q7RUFFQVgsWUFBWUEsQ0FBQSxFQUFJO0lBQ2QsSUFBSSxDQUFDUSxNQUFNLEdBQUcsSUFBSWYseURBQU0sQ0FBQztNQUN2Qm1CLFFBQVEsRUFBRSxJQUFJLENBQUNBO0lBQ2pCLENBQUMsQ0FBQztFQUNKO0VBRUFiLGFBQWFBLENBQUEsRUFBSTtJQUNmLElBQUksQ0FBQ2MsT0FBTyxHQUFHQyxRQUFRLENBQUNDLGFBQWEsQ0FBQyxVQUFVLENBQUM7SUFDakQsSUFBSSxDQUFDSCxRQUFRLEdBQUcsSUFBSSxDQUFDQyxPQUFPLENBQUNHLFlBQVksQ0FBQyxlQUFlLENB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LElBQUksQ0FBQ04sV0FBVyxDQUFDekMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pFZSxNQUFNLENBQUNnQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDTCxTQUFTLENBQUMxQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFN0RlLE1BQU0sQ0FBQ2dDLGdCQUFnQixDQUFDLFlBQVksRUFBRSxJQUFJLENBQUNSLFdBQVcsQ0FBQ3ZDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNsRWUsTUFBTSxDQUFDZ0MsZ0JBQWdCLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQ04sV0FBVyxDQUFDekMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pFZSxNQUFNLENBQUNnQyxnQkFBZ0IsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDTCxTQUFTLENBQUMxQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFOURlLE1BQU0sQ0FBQ2dDLGdCQUFnQixDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUNuQyxVQUFVLENBQUNaLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUUvRGUsTUFBTSxDQUFDZ0MsZ0JBQWdCLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQ3JELFFBQVEsQ0FBQ00sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0VBQzdEO0FBQ0Y7QUFFQSxJQUFJZCxHQUFHLENBQUMsQ0FBQzs7Ozs7Ozs7VUNoTVQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ib2lsZXJwbGF0ZS1wcmlzbWljLy4vYXBwL2luZGV4LmpzIiwid2VicGFjazovL2JvaWxlcnBsYXRlLXByaXNtaWMvd2VicGFjay9ydW50aW1lL2dldEZ1bGxIYXNoIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBOb3JtYWxpemVXaGVlbCBmcm9tICdub3JtYWxpemUtd2hlZWwnXHJcblxyXG5pbXBvcnQgZWFjaCBmcm9tICdsb2Rhc2gvZWFjaCdcclxuXHJcbmltcG9ydCBDYW52YXMgZnJvbSAnY29tcG9uZW50cy9DYW52YXMnXHJcblxyXG5pbXBvcnQgUHJlbG9hZGVyIGZyb20gJ2NvbXBvbmVudHMvUHJlbG9hZGVyJ1xyXG5cclxuaW1wb3J0IEFib3V0IGZyb20gJ3BhZ2VzL0Fib3V0J1xyXG5pbXBvcnQgSG9tZSBmcm9tICdwYWdlcy9Ib21lJ1xyXG5jbGFzcyBBcHAge1xyXG4gIGNvbnN0cnVjdG9yICgpIHtcclxuICAgIHRoaXMuY3JlYXRlQ29udGVudCgpXHJcblxyXG4gICAgdGhpcy5jcmVhdGVDYW52YXMoKVxyXG4gICAgdGhpcy5jcmVhdGVQcmVsb2FkZXIoKVxyXG4gICAgdGhpcy5jcmVhdGVQYWdlcygpXHJcblxyXG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVycygpXHJcbiAgICB0aGlzLmFkZExpbmtMaXN0ZW5lcnMoKVxyXG5cclxuICAgIHRoaXMub25SZXNpemUoKVxyXG5cclxuICAgIHRoaXMudXBkYXRlKClcclxuICB9XHJcblxyXG4gIGNyZWF0ZVByZWxvYWRlciAoKSB7XHJcbiAgICB0aGlzLnByZWxvYWRlciA9IG5ldyBQcmVsb2FkZXIoe1xyXG4gICAgICBjYW52YXM6IHRoaXMuY2FudmFzXHJcbiAgICB9KVxyXG4gICAgdGhpcy5wcmVsb2FkZXIub25jZSgnY29tcGxldGVkJywgdGhpcy5vblByZWxvYWRlZC5iaW5kKHRoaXMpKVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlQ2FudmFzICgpIHtcclxuICAgIHRoaXMuY2FudmFzID0gbmV3IENhbnZhcyh7XHJcbiAgICAgIHRlbXBsYXRlOiB0aGlzLnRlbXBsYXRlXHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgY3JlYXRlQ29udGVudCAoKSB7XHJcbiAgICB0aGlzLmNvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udGVudCcpXHJcbiAgICB0aGlzLnRlbXBsYXRlID0gdGhpcy5jb250ZW50LmdldEF0dHJpYnV0ZSgnZGF0YS10ZW1wbGF0ZScpXHJcbiAgfVxyXG5cclxuICBjcmVhdGVQYWdlcyAoKSB7XHJcbiAgICB0aGlzLnBhZ2VzID0ge1xyXG4gICAgICBhYm91dDogbmV3IEFib3V0KCksXHJcbiAgICAgIGhvbWU6IG5ldyBIb21lKClcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnBhZ2UgPSB0aGlzLnBhZ2VzW3RoaXMudGVtcGxhdGVdXHJcbiAgICB0aGlzLnBhZ2UuY3JlYXRlKClcclxuXHJcbiAgICB0aGlzLm9uUmVzaXplKClcclxuICB9XHJcblxyXG4gIC8qKioqXHJcbiAgICogRVZFTlRTXHJcbiAgICogKioqL1xyXG4gIG9uUHJlbG9hZGVkICgpIHtcclxuICAgIHRoaXMub25SZXNpemUoKVxyXG5cclxuICAgIHRoaXMuY2FudmFzLm9uUHJlbG9hZGVkKClcclxuXHJcbiAgICB0aGlzLnBhZ2Uuc2hvdygpXHJcbiAgfVxyXG5cclxuICBvblBvcFN0YXRlICgpIHtcclxuICAgIHRoaXMub25DaGFuZ2Uoe1xyXG4gICAgICB1cmw6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSxcclxuICAgICAgcHVzaDogZmFsc2VcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBhc3luYyBvbkNoYW5nZSAoeyB1cmwsIHB1c2ggPSB0cnVlIH0pIHtcclxuICAgIHRoaXMuY2FudmFzLm9uQ2hhbmdlU3RhcnQodGhpcy50ZW1wbGF0ZSwgdXJsKVxyXG4gICAgYXdhaXQgdGhpcy5wYWdlLmhpZGUoKVxyXG5cclxuICAgIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCB3aW5kb3cuZmV0Y2godXJsKVxyXG4gICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgY29uc3QgaHRtbCA9IGF3YWl0IHJlcXVlc3QudGV4dCgpXHJcbiAgICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXHJcblxyXG4gICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sICcnLCB1cmwpXHJcblxyXG4gICAgICBpZiAocHVzaCkge1xyXG4gICAgICAgIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSh7fSwgJycsIHVybClcclxuICAgICAgfVxyXG5cclxuICAgICAgZGl2LmlubmVySFRNTCA9IGh0bWxcclxuXHJcbiAgICAgIGNvbnN0IGRpdkNvbnRlbnQgPSBkaXYucXVlcnlTZWxlY3RvcignLmNvbnRlbnQnKVxyXG5cclxuICAgICAgdGhpcy50ZW1wbGF0ZSA9IGRpdkNvbnRlbnQuZ2V0QXR0cmlidXRlKCdkYXRhLXRlbXBsYXRlJylcclxuXHJcbiAgICAgIHRoaXMubmF2aWdhdGlvbi5vbkNoYW5nZSh0aGlzLnRlbXBsYXRlKVxyXG5cclxuICAgICAgdGhpcy5jb250ZW50LnNldEF0dHJpYnV0ZSgnZGF0YS10ZW1wbGF0ZScsIHRoaXMudGVtcGxhdGUpXHJcbiAgICAgIHRoaXMuY29udGVudC5pbm5lckhUTUwgPSBkaXZDb250ZW50LmlubmVySFRNTFxyXG5cclxuICAgICAgdGhpcy5jYW52YXMub25DaGFuZ2VFbmQodGhpcy50ZW1wbGF0ZSlcclxuXHJcbiAgICAgIHRoaXMucGFnZSA9IHRoaXMucGFnZXNbdGhpcy50ZW1wbGF0ZV1cclxuICAgICAgdGhpcy5wYWdlLmNyZWF0ZSgpXHJcblxyXG4gICAgICB0aGlzLm9uUmVzaXplKClcclxuXHJcbiAgICAgIHRoaXMucGFnZS5zaG93KClcclxuXHJcbiAgICAgIHRoaXMuYWRkTGlua0xpc3RlbmVycygpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmxvZygnRXJyb3InKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb25SZXNpemUgKCkge1xyXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShfID0+IHtcclxuICAgICAgaWYgKHRoaXMuY2FudmFzICYmIHRoaXMuY2FudmFzLm9uUmVzaXplKSB7XHJcbiAgICAgICAgdGhpcy5jYW52YXMub25SZXNpemUoKVxyXG4gICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIGlmICh0aGlzLnBhZ2UgJiYgdGhpcy5wYWdlLm9uUmVzaXplKSB7XHJcbiAgICAgIHRoaXMucGFnZS5vblJlc2l6ZSgpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvblRvdWNoRG93biAoZXZlbnQpIHtcclxuICAgIGlmICh0aGlzLmNhbnZhcyAmJiB0aGlzLmNhbnZhcy5vblRvdWNoRG93bikge1xyXG4gICAgICB0aGlzLmNhbnZhcy5vblRvdWNoRG93bihldmVudClcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9uVG91Y2hNb3ZlIChldmVudCkge1xyXG4gICAgaWYgKHRoaXMuY2FudmFzICYmIHRoaXMuY2FudmFzLm9uVG91Y2hNb3ZlKSB7XHJcbiAgICAgIHRoaXMuY2FudmFzLm9uVG91Y2hNb3ZlKGV2ZW50KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb25Ub3VjaFVwIChldmVudCkge1xyXG4gICAgaWYgKHRoaXMuY2FudmFzICYmIHRoaXMuY2FudmFzLm9uVG91Y2hVcCkge1xyXG4gICAgICB0aGlzLmNhbnZhcy5vblRvdWNoVXAoZXZlbnQpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbldoZWVsIChldmVudCkge1xyXG4gICAgY29uc3Qgbm9ybWFsaXplZFdoZWVsID0gTm9ybWFsaXplV2hlZWwoZXZlbnQpXHJcblxyXG4gICAgaWYgKHRoaXMuY2FudmFzICYmIHRoaXMuY2FudmFzLnVwZGF0ZSkge1xyXG4gICAgICB0aGlzLmNhbnZhcy5vbldoZWVsKG5vcm1hbGl6ZWRXaGVlbClcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5wYWdlICYmIHRoaXMucGFnZS51cGRhdGUpIHtcclxuICAgICAgdGhpcy5wYWdlLm9uV2hlZWwobm9ybWFsaXplZFdoZWVsKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqKipcclxuICAgKiBMT09QU1xyXG4gICAqICoqKi9cclxuICB1cGRhdGUgKCkge1xyXG4gICAgaWYgKHRoaXMucGFnZSAmJiB0aGlzLnBhZ2UudXBkYXRlKSB7XHJcbiAgICAgIHRoaXMucGFnZS51cGRhdGUoKVxyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLmNhbnZhcyAmJiB0aGlzLmNhbnZhcy51cGRhdGUpIHtcclxuICAgICAgdGhpcy5jYW52YXMudXBkYXRlKHRoaXMucGFnZS5zY3JvbGwpXHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5mcmFtZSA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy51cGRhdGUuYmluZCh0aGlzKSlcclxuICB9XHJcblxyXG4gIC8qKioqXHJcbiAgICogTElTVEVORVJTXHJcbiAgICogKioqL1xyXG4gIGFkZEV2ZW50TGlzdGVuZXJzICgpIHtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXdoZWVsJywgdGhpcy5vbldoZWVsLmJpbmQodGhpcykpXHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMub25Ub3VjaERvd24uYmluZCh0aGlzKSlcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLm9uVG91Y2hNb3ZlLmJpbmQodGhpcykpXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMub25Ub3VjaFVwLmJpbmQodGhpcykpXHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLm9uVG91Y2hEb3duLmJpbmQodGhpcykpXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdGhpcy5vblRvdWNoTW92ZS5iaW5kKHRoaXMpKVxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdGhpcy5vblRvdWNoVXAuYmluZCh0aGlzKSlcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncG9wc3RhdGUnLCB0aGlzLm9uUG9wU3RhdGUuYmluZCh0aGlzKSlcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5vblJlc2l6ZS5iaW5kKHRoaXMpKVxyXG4gIH1cclxufVxyXG5cclxubmV3IEFwcCgpXHJcbiIsIl9fd2VicGFja19yZXF1aXJlX18uaCA9ICgpID0+IChcImFjNTBhZjc2YzIxYTIwMjc3YWE3XCIpIl0sIm5hbWVzIjpbIk5vcm1hbGl6ZVdoZWVsIiwiZWFjaCIsIkNhbnZhcyIsIlByZWxvYWRlciIsIkFib3V0IiwiSG9tZSIsIkFwcCIsImNvbnN0cnVjdG9yIiwiY3JlYXRlQ29udGVudCIsImNyZWF0ZUNhbnZhcyIsImNyZWF0ZVByZWxvYWRlciIsImNyZWF0ZVBhZ2VzIiwiYWRkRXZlbnRMaXN0ZW5lcnMiLCJhZGRMaW5rTGlzdGVuZXJzIiwib25SZXNpemUiLCJ1cGRhdGUiLCJwcmVsb2FkZXIiLCJjYW52YXMiLCJvbmNlIiwib25QcmVsb2FkZWQiLCJiaW5kIiwidGVtcGxhdGUiLCJjb250ZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2V0QXR0cmlidXRlIiwicGFnZXMiLCJhYm91dCIsImhvbWUiLCJwYWdlIiwiY3JlYXRlIiwic2hvdyIsIm9uUG9wU3RhdGUiLCJvbkNoYW5nZSIsInVybCIsIndpbmRvdyIsImxvY2F0aW9uIiwicGF0aG5hbWUiLCJwdXNoIiwib25DaGFuZ2VTdGFydCIsImhpZGUiLCJyZXF1ZXN0IiwiZmV0Y2giLCJzdGF0dXMiLCJodG1sIiwidGV4dCIsImRpdiIsImNyZWF0ZUVsZW1lbnQiLCJoaXN0b3J5IiwicHVzaFN0YXRlIiwiaW5uZXJIVE1MIiwiZGl2Q29udGVudCIsIm5hdmlnYXRpb24iLCJzZXRBdHRyaWJ1dGUiLCJvbkNoYW5nZUVuZCIsImNvbnNvbGUiLCJsb2ciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJfIiwib25Ub3VjaERvd24iLCJldmVudCIsIm9uVG91Y2hNb3ZlIiwib25Ub3VjaFVwIiwib25XaGVlbCIsIm5vcm1hbGl6ZWRXaGVlbCIsInNjcm9sbCIsImZyYW1lIiwiYWRkRXZlbnRMaXN0ZW5lciJdLCJzb3VyY2VSb290IjoiIn0=